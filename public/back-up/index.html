<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>

    <title>Ventari Questionnaire Manager</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/main.css"/>
    <link rel="stylesheet" href="css/vendor/font-awesome-4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/vendor/bootstrap-3.3.5-dist/css/bootstrap.css">
    <link rel="stylesheet" href="css/vendor/bootstrap-3.3.5-dist/css/bootstrap-theme.min.css">

</head>
<body>

<div class="questionnaire">
    <div class="question-pool">
        <div class="row question nopadding" id="1">
            <div class="col-xs-12 nopadding">

                <!-- Question/Answer Header -->
                <div class="row question-header">
                    <div class="col-xs-2 question-number">
                        <h1>Question #1</h1>
                    </div>
                    <div class="col-xs-8 question-type">
                        <h1>Type:</h1>
                        <div>
                            <select id="question-type">
                                <option value="single-answer" selected>Single Answer</option>
                                <option value="choose-any">Choose Any</option>
                                <option value="true-false">True or False</option>
                                <option value="yes-no">Yes or No</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-xs-2 question-delete">
                        <button>Delete</button>
                    </div>
                </div>


                <!-- Question/Answer Section -->
                <div class="row question-body nopadding">
                    <div class="col-xs-12 nopadding">

                        <!-- Question Input -->
                        <div class="row question-text nopadding">
                            <div class="col-xs-12 nopadding">
                                <textarea class="expanding" placeholder="Type question here"></textarea>
                            </div>
                        </div>
                        <div class="row question-separator nopadding"></div>
                    </div>
                </div>

                <div class="row answer-body nopadding">
                    <div class="col-xs-12 nopadding">

                        <!-- Single Answer -->
                        <div class="row single-answer nopadding active">

                            <!-- Answer 1 -->
                            <div class="row answer-text" id="1">
                                <div class="col-xs-9 nopadding">
                                    <h1>Answer 1</h1>
                                    <textarea class="expanding" placeholder="Type answer here"></textarea>
                                </div>
                                <div class="col-xs-2 answer-weight nopadding">
                                    <h1>Weight</h1>
                                    <input type="text" placeholder="#" value="0">
                                </div>
                                <div class="col-xs-1 answer-delete nopadding">
                                    <i class="fa fa-times-circle-o"></i>
                                </div>
                            </div>
                            <div class="row answer-separator nopadding"></div>

                            <!-- Answer 2 -->
                            <div class="row answer-text" id="2">
                                <div class="col-xs-9 nopadding">
                                    <h1>Answer 2</h1>
                                    <textarea class="expanding" placeholder="Type answer here"></textarea>
                                </div>
                                <div class="col-xs-2 answer-weight nopadding">
                                    <h1>Weight</h1>
                                    <input type="text" placeholder="#" value="0">
                                </div>
                                <div class="col-xs-1 answer-delete nopadding">
                                    <i class="fa fa-times-circle-o"></i>
                                </div>
                            </div>
                            <div class="row answer-separator nopadding"></div>
                        </div>

                        <!-- Choose Any -->
                        <div class="row choose-any nopadding">

                            <!-- Answer 1 -->
                            <div class="row answer-text" id="1">
                                <div class="col-xs-9 nopadding">
                                    <h1>Answer 1</h1>
                                    <textarea class="expanding" placeholder="Type answer here"></textarea>
                                </div>
                                <div class="col-xs-2 answer-weight nopadding">
                                    <h1>Weight</h1>
                                    <input type="text" placeholder="#" value="0">
                                </div>
                                <div class="col-xs-1 answer-delete nopadding">
                                    <i class="fa fa-times-circle-o"></i>
                                </div>
                            </div>
                            <div class="row answer-separator nopadding"></div>

                            <!-- Answer 2 -->
                            <div class="row answer-text" id="2">
                                <div class="col-xs-9 nopadding">
                                    <h1>Answer 2</h1>
                                    <textarea class="expanding" placeholder="Type answer here"></textarea>
                                </div>
                                <div class="col-xs-2 answer-weight nopadding">
                                    <h1>Weight</h1>
                                    <input type="text" placeholder="#" value="0">
                                </div>
                                <div class="col-xs-1 answer-delete nopadding">
                                    <i class="fa fa-times-circle-o"></i>
                                </div>
                            </div>
                            <div class="row answer-separator nopadding"></div>
                        </div>

                        <!-- Yes or No -->
                        <div class="row yes-no nopadding">
                            <div class="row answer-text" id="1">
                                <div class="col-xs-9 nopadding">
                                    <h1>Answer 1</h1>
                                    <textarea class="expanding disable" placeholder="Type answer here">Yes</textarea>
                                </div>
                                <div class="col-xs-2 answer-weight nopadding">
                                    <h1>Weight</h1>
                                    <input type="text" placeholder="#" value="0">
                                </div>
                                <div class="col-xs-1 answer-delete nopadding">
                                    <i class="fa fa-times-circle-o"></i>
                                </div>
                            </div>
                            <div class="row answer-separator nopadding"></div>
                            <div class="row answer-text" id="1">
                                <div class="col-xs-9 nopadding">
                                    <h1>Answer 2</h1>
                                    <textarea class="expanding disable" placeholder="Type answer here">No</textarea>
                                </div>
                                <div class="col-xs-2 answer-weight nopadding">
                                    <h1>Weight</h1>
                                    <input type="text" placeholder="#" value="0">
                                </div>
                                <div class="col-xs-1 answer-delete nopadding">
                                    <i class="fa fa-times-circle-o"></i>
                                </div>
                            </div>
                            <div class="row answer-separator nopadding"></div>
                        </div>

                        <!-- True or False -->
                        <div class="row true-false nopadding">
                            <div class="row answer-text" id="1">
                                <div class="col-xs-9 nopadding">
                                    <h1>Answer 1</h1>
                                    <textarea class="expanding disable" placeholder="Type answer here">True</textarea>
                                </div>
                                <div class="col-xs-2 answer-weight nopadding">
                                    <h1>Weight</h1>
                                    <input type="text" placeholder="#" value="0">
                                </div>
                                <div class="col-xs-1 answer-delete nopadding">
                                    <i class="fa fa-times-circle-o"></i>
                                </div>
                            </div>
                            <div class="row answer-separator nopadding"></div>
                            <div class="row answer-text" id="1">
                                <div class="col-xs-9 nopadding">
                                    <h1>Answer 2</h1>
                                    <textarea class="expanding disable" placeholder="Type answer here">False</textarea>
                                </div>
                                <div class="col-xs-2 answer-weight nopadding">
                                    <h1>Weight</h1>
                                    <input type="text" placeholder="#" value="0">
                                </div>
                                <div class="col-xs-1 answer-delete nopadding">
                                    <i class="fa fa-times-circle-o"></i>
                                </div>
                            </div>
                            <div class="row answer-separator nopadding"></div>
                        </div>

                    </div>
                </div>

                <!-- Add Answer Section -->
                <div class="row answer-add">
                    <div class="col-xs-12 nopadding">
                        <button>+ Add Answer</button>
                    </div>
                </div>


            </div>
        </div> <!-- question-1 -->
    </div>

    <!-- Add Question Button -->
    <div class="question-add">
        <div class="row nopadding">
            <button>+ Add Question</button>
        </div>
    </div>
</div>

<script src="js/vendor/jquery-1.11.3.min.js"></script>
<script src="js/vendor/jquery-ui-1.11.4/jquery-ui.js"></script>
<script src="js/vendor/expanding.js"></script>
<script>

    $(document).ready(function() {
        $.expanding.initialSelector = "textarea";
        // By default, show multiple-choice and hide the rest.
        $(".single-answer").show().addClass("active").siblings().removeClass("active").hide();

        // Select onchange
        $(".question-pool").on("change", "#question-type", function() {
            var id = $(this).val();
            $(this).parents(".question").find("." + id).show().addClass("active").siblings().removeClass("active").hide();

            // If yes-no or true-false, don't allow to add answers
            if (id == "yes-no" || id == "true-false") {
                $(this).parents(".question").find(".answer-add").hide();
            }
            else {
                $(this).parents(".question").find(".answer-add").show();
            }
        });

        // Add answer option to corresponding question
        $(".question-pool").on("click", ".answer-add button", function() {
            //console.log($(this).parents(".question").attr('id'));
            var index = parseInt($(this).parents(".question").find(".answer-body").find(".active").find(".answer-text").last().attr("id")) + 1;
            //console.log("adding to index: " + index);

            var answer =
                $('<div/>', {
                    class: 'row answer-text',
                    id: index
                })
                .append(
                    $('<div/>', {
                        class: 'col-xs-9 nopadding'
                    })
                    .append(
                        $('<h1/>', {
                            text: 'Answer ' + index
                        })
                    )
                    .append(
                        $('<textarea/>', {
                            class: 'expanding',
                            placeholder: 'Type answer here'
                        })
                    )
                )
                .append(
                    $('<div/>', {
                        class: 'col-xs-2 answer-weight nopadding'
                    })
                    .append(
                        $('<h1/>', {
                            text: 'Weight'
                        })
                    )
                    .append(
                        $('<input/>', {
                            type: 'text',
                            placeholder: '#',
                            value: '0'
                        })
                    )
                )
                .append(
                    $('<div/>', {
                        class: 'col-xs-1 answer-delete nopadding'
                    })
                    .append(
                        $('<i/>', {
                            class: 'fa fa-times-circle-o'
                        })
                    )
                );

                var separator =
                    $('<div/>', {
                        class: 'row answer-separator nopadding'
                    });

            $(this).parents(".question").find(".answer-body").find(".active").append(answer).append(separator);
            $(this).parents(".question").find(".answer-body").find(".active").find("textarea").last().expanding();
        });

        //todo: delete answer and re-index answer list
        $(".question-pool").on("click", ".answer-delete i", function() {
            //save parent object

            $(this).parents(".answer-text").remove();
        });


        // Add question to question pool
        $(".question-add button").on("click", function() {

            var index = parseInt($(this).parents(".questionnaire").find(".question").last().attr("id")) + 1;

            var question = '<div class="row question nopadding" id="' + index + '">' + '<div class="col-xs-12 nopadding">' + '<div class="row question-header">' + '<div class="col-xs-2 question-number">' + '<h1>Question #' + index + '</h1>' + '</div>' + '<div class="col-xs-8 question-type">' + '<h1>Type:</h1>' + '<div>' + '<select id="question-type">' + '<option value="single-answer" selected>Single Answer</option>' + '<option value="choose-any">Choose Any</option>' + '<option value="true-false">True or False</option>' + '<option value="yes-no">Yes or No</option>' + '</select>' + '</div>' + '</div>' + '<div class="col-xs-2 question-delete">' + '<button>Delete</button>' + '</div>' + '</div>' + '<div class="row question-body nopadding">' + '<div class="col-xs-12 nopadding">' + '<div class="row question-text nopadding">' + '<div class="col-xs-12 nopadding">' + '<textarea class="expanding" placeholder="Type question here"></textarea>' + '</div>' + '</div>' + '<div class="row question-separator nopadding"></div>' + '</div>' + '</div>' + '<div class="row answer-body nopadding">' + '<div class="col-xs-12 nopadding">' + '<div class="row single-answer nopadding active" id="single-answer">' + '<div class="row answer-text" id="1">' + '<div class="col-xs-9 nopadding">' + '<h1>Answer 1</h1>' + '<textarea class="expanding" placeholder="Type answer here"></textarea>' + '</div>' + '<div class="col-xs-2 answer-weight nopadding">' + '<h1>Weight</h1>' + '<input type="text" placeholder="#" value="0">' + '</div>' + '<div class="col-xs-1 answer-delete nopadding">' + '<i class="fa fa-times-circle-o"></i>' + '</div>' + '</div>' + '<div class="row answer-separator nopadding"></div>' + '<div class="row answer-text" id="2">' + '<div class="col-xs-9 nopadding">' + '<h1>Answer 2</h1>' + '<textarea class="expanding" placeholder="Type answer here"></textarea>' + '</div>' + '<div class="col-xs-2 answer-weight nopadding">' + '<h1>Weight</h1>' + '<input type="text" placeholder="#" value="0">' + '</div>' + '<div class="col-xs-1 answer-delete nopadding">' + '<i class="fa fa-times-circle-o"></i>' + '</div>' + '</div>' + '<div class="row answer-separator nopadding"></div>' + '</div>' + '<div class="row choose-any nopadding" id="choose-any">' + '<div class="row answer-text" id="1">' + '<div class="col-xs-9 nopadding">' + '<h1>Option 1</h1>' + '<textarea class="expanding" placeholder="Type answer here"></textarea>' + '</div>' + '<div class="col-xs-2 answer-weight nopadding">' + '<h1>Weight</h1>' + '<input type="text" placeholder="#" value="0">' + '</div>' + '<div class="col-xs-1 answer-delete nopadding">' + '<i class="fa fa-times-circle-o"></i>' + '</div>' + '</div>' + '<div class="row answer-separator nopadding"></div>' + '<div class="row answer-text" id="2">' + '<div class="col-xs-9 nopadding">' + '<h1>Option 2</h1>' + '<textarea class="expanding" placeholder="Type answer here"></textarea>' + '</div>' + '<div class="col-xs-2 answer-weight nopadding">' + '<h1>Weight</h1>' + '<input type="text" placeholder="#" value="0">' + '</div>' + '<div class="col-xs-1 answer-delete nopadding">' + '<i class="fa fa-times-circle-o"></i>' + '</div>' + '</div>' + '<div class="row answer-separator nopadding"></div>' + '</div>' + '<div class="row yes-no nopadding" id="yes-no">' + '<div class="row answer-text" id="1">' + '<div class="col-xs-9 nopadding">' + '<h1>Answer 1</h1>' + '<textarea class="expanding disable" placeholder="Type answer here">Yes</textarea>' + '</div>' + '<div class="col-xs-2 answer-weight nopadding">' + '<h1>Weight</h1>' + '<input type="text" placeholder="#" value="0">' + '</div>' + '<div class="col-xs-1 answer-delete nopadding"></div>' + '</div>' + '<div class="row answer-separator nopadding"></div>' + '<div class="row answer-text" id="2">' + '<div class="col-xs-9 nopadding">' + '<h1>Answer 2</h1>' + '<textarea class="expanding disable" placeholder="Type answer here">No</textarea>' + '</div>' + '<div class="col-xs-2 answer-weight nopadding">' + '<h1>Weight</h1>' + '<input type="text" placeholder="#" value="0">' + '</div>' + '<div class="col-xs-1 answer-delete nopadding"></div>' + '</div>' + '<div class="row answer-separator nopadding"></div>' + '</div>' + '<div class="row true-false nopadding" id="true-false">' + '<div class="row answer-text" id="1">' + '<div class="col-xs-9 nopadding">' + '<h1>Answer 1</h1>' + '<textarea class="expanding disable" placeholder="Type answer here">True</textarea>' + '</div>' + '<div class="col-xs-2 answer-weight nopadding">' + '<h1>Weight</h1>' + '<input type="text" placeholder="#" value="0">' + '</div>' + '<div class="col-xs-1 answer-delete nopadding"></div>' + '</div>' + '<div class="row answer-separator nopadding"></div>' + '<div class="row answer-text" id="2">' + '<div class="col-xs-9 nopadding">' + '<h1>Answer 2</h1>' + '<textarea class="expanding disable" placeholder="Type answer here">False</textarea>' + '</div>' + '<div class="col-xs-2 answer-weight nopadding">' + '<h1>Weight</h1>' + '<input type="text" placeholder="#" value="0">' + '</div>' + '<div class="col-xs-1 answer-delete nopadding"></div>' + '</div>' + '<div class="row answer-separator nopadding"></div>' + '</div>' + '</div>' + '</div>' + '<div class="row answer-add">' + '<div class="col-xs-12 nopadding">' + '<button>+ Add Answer</button>' + '</div>' + '</div>' + '</div>' + '</div>';

            $(this).parents(".questionnaire").find(".question-pool").append(question);
            $(this).parents(".questionnaire").find(".question").last().find("textarea").expanding();
            $(this).parents(".questionnaire").find(".question").last().find(".single-answer").show().addClass("active").siblings().removeClass("active").hide();

        });
    });




    $(function() {
        $( "#sortable1, #sortable2" ).sortable({
            placeholder: "sortable-placeholder",
            tolerance: "pointer",
            connectWith: ".connectedSortable",
            update : function () {
                var order1 = $('#sortable1').sortable('toArray').toString();
                //alert("Order 1:"+order1);
            },
            start: function(event, ui){
                $(ui.item).height(20);
            }
        }).disableSelection();
    });

    // Slide toggle
    $(".fa-angle-up").on("click", function() {
        $(this).parent().parent().children('div').eq(1).slideUp(400);
        $(this).hide().siblings('.fa-angle-down').show();
    });
    $('.fa-angle-down').on('click', function() {
        $(this).parent().parent().children('div').eq(1).slideDown(400);
        $(this).hide().siblings('.fa-angle-up').show();
    });

    $('#addSurvey').click(function() {
        console.log('adding new survey to list');

        // Create Q/A
        //var

        // Append to list
//        $('#sortable1').append();
    });

    // Create multipleChoice


    // Change Answer Type
    $(document).ready(function() {
        $("li").click(function(event) {
            //alert(event.target.id);
        });
    });
    //document.getElementById("myText").readOnly = true;




    function createQuestion(questiontype) {
        if (questiontype == "single") {
            $('#sortable1').append('<li class="survey-question ui-state-default" id="item1">'
                    + '<div class="question">'
                    + '<i class="fa fa-sort"></i><input type="text" name="question1" placeholder="question" value=""><i class="fa fa-angle-up"></i><i class="fa fa-angle-down" style="display:none;"></i>'
                    + '</div>'
                    + '<div class="answers">'
                    + '<div class="answers-list" id="item1">'
                    + '<div class="list">'
                    + '<input type="text" name="answer1" placeholder="answer" value=""><input type="text" name="weight" placeholder="weight" value=""><br>'
                    + '<input type="text" name="answer2" placeholder="answer" value=""><input type="text" name="weight" placeholder="weight" value=""><br>'
                    + '</div>'
                    + '<button onClick="addAnswer(this.parentElement)">add more options</button>'
                    + '</div>'
                    + '</div>'
                    + '</li>');
        }
        else if (question-type == "choose") {
            $('#sortable1').append('<li class="survey-question ui-state-default" id="item1">'
                    + '<div class="question">'
                    + '<i class="fa fa-sort"></i><input type="text" name="question1" placeholder="question" value=""><i class="fa fa-angle-up"></i><i class="fa fa-angle-down" style="display:none;"></i>'
                    + '</div>'
                    + '<div class="answers">'
                    + '<div class="answers-list" id="item1">'
                    + '<div class="list">'
                    + '<input type="text" name="answer1" placeholder="answer" value=""><input type="text" name="weight" placeholder="weight" value=""><br>'
                    + '<input type="text" name="answer2" placeholder="answer" value=""><input type="text" name="weight" placeholder="weight" value=""><br>'
                    + '</div>'
                    + '<button onClick="addAnswer(this.parentElement)">add more options</button>'
                    + '</div>'
                    + '</div>'
                    + '</li>');
        }
        else if (question-type == "likert") {
            $('#sortable1').append('<li class="survey-question ui-state-default" id="item4">'
                    + '<div class="question">'
                    + '<i class="fa fa-sort"></i><input type="text" name="question1" placeholder="question" value=""><i class="fa fa-angle-up"></i><i class="fa fa-angle-down" style="display:none;"></i>'
                    + '</div>'
                    + '<div class="answers">'
                    + '<table class="">'
                    + '<thead>'
                    + '<tr>'
                    + '<th></th>'
                    + '<th>1</th>'
                    + '<th>2</th>'
                    + '<th>3</th>'
                    + '<th>4</th>'
                    + '<th>5</th>'
                    + '<th></th>'
                    + '</tr>'
                    + '</thead>'
                    + '<tbody>'
                    + '<tr>'
                    + '<td>least?</td>'
                    + '<td><input type="radio" value="1" name="something"/></td>'
                    + '<td><input type="radio" value="2" name="something"/></td>'
                    + '<td><input type="radio" value="3" name="something"/></td>'
                    + '<td><input type="radio" value="4" name="something"/></td>'
                    + '<td><input type="radio" value="5" name="something"/></td>'
                    + '<td>most</td>'
                    + '</tr>'
                    + '</tbody>'
                    + '</table>'
                    + '</div>'
                    + '</li>');
        }
    }

</script>
</body>
</html>
